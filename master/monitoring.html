

<!DOCTYPE html>
<html class="no-js" lang="en">
    
    

    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width initial-scale=1" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>
             Monitoring | ScyllaDB Docs 
        </title>
        <meta name="description" content="ScyllaDB is an Apache Cassandra-compatible NoSQL data store that can handle 1 million transactions per second on a single server." />
        <link rel="icon" href="_static/img/favicon.ico" type="image/x-icon" />
        <link rel="icon" href="_static/img/favicon-32x32.png" sizes="32x32" />
        <link rel="icon" href="_static/img/favicon-228x228.png" sizes="192x192" />
        <link rel="apple-touch-icon" href="_static/img/favicon-228x228.png" />
        <meta name="msapplication-TileImage" href="_static/img/favicon-228x228.png" />

        
            
            
        

        
            <link rel="canonical" href="https://operator.docs.scylladb.com/monitoring.html"/>
        

        <link rel="author" href="mailto:info@scylladb.com" />

        
            
        <!-- increase expertrec loading priority-->
        <link rel="dns-prefetch" href="https://cse.expertrec.com">

        <!-- increase font loading priority -->
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link rel="preload" as="style"
            href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,400;0,500;0,700;1,400&display=swap" />

        <!-- async CSS -->
        <link rel="stylesheet" media="print" onload="this.onload=null;this.removeAttribute('media');"
            href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,400;0,500;0,700;1,400&display=swap" />

        <!-- no-JS fallback -->
        <noscript>
            <link rel="stylesheet"
                href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,400;0,500;0,700;1,400&display=swap" />
        </noscript>
        
            
                <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
            
        
            
                <link rel="stylesheet" type="text/css" href="_static/css/main.css" />
            
        
            
                <link rel="stylesheet" type="text/css" href="_static/sphinx_collapse.css" />
            
        
            
                <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
            
        
    
        
        
            

        <script type="text/javascript" id="documentation_options" data-url_root="./"
            src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/js/runtime.bundle.js"></script>
        <script type="text/javascript" src="_static/js/main.bundle.js"></script>
        
            
                <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
            
        
            
        
            
                <script src="_static/underscore.js"></script>
            
        
            
                <script src="_static/doctools.js"></script>
            
        
            
                <script src="_static/clipboard.min.js"></script>
            
        
            
                <script src="_static/copybutton.js"></script>
            
        
    
            <!- Zendesk tag -->
<meta name='zd-site-verification' content='gq6ltsh3nfex3cnwfy4aj9' />
<!-- Google Tag Manager -->
<script>
    (function (w, d, s, l, i) {
        w[l] = w[l] || [];
        w[l].push({
            "gtm.start": new Date().getTime(),
            event: "gtm.js"
        });
        var f = d.getElementsByTagName(s)[0],
        j = d.createElement(s),
        dl = l != "dataLayer" ? "&l=" + l : "";
        j.async = true;
        j.src = "https://www.googletagmanager.com/gtm.js?id=" + i + dl;
        f.parentNode.insertBefore(j, f);
    })(window, document, "script", "dataLayer", "GTM-T8P2JP");
</script>
<!-- End Google Tag Manager -->

<!-- Expertrec -->
<script>
    var id = "e2077224-9ccf-11e9-a0c9-0242ac130002";
    var ci_search = document.createElement("script");
    ci_search.type = "text/javascript";
    ci_search.async = true;
    ci_search.src = "https://cse.expertrec.com/api/js/ci_common.js?id=" + id;
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(ci_search, s);
</script>
<!-- End Expertrec -->
        
        <!-- Font Awesome -->
        <script src="https://kit.fontawesome.com/b1870adf6a.js" crossorigin="anonymous"></script>
        <!-- End Font Awesome -->
    </head>

    <body>
        
        <header class="header">
    <div class="header-logo">
        <a class="header-logo__img" href="https://scylladb.com/">
            <img src="_static/img/logo-docs.svg" alt="ScyllaDB Documentation Logo" />
        </a>
        <span class="header-logo__bar"></span>
        <a class="header-logo__text" href="https://docs.scylladb.com/">
            Documentation
        </a>
    </div>
    <div class="header-navigation">
        <ul class="dropdown menu scylla-dropdown scylla-dropdown--header" data-dropdown-menu>
            <li class="scylla-dropdown__item">
                <a href="#" class="scylla-dropdown__title">Server
                    <i class="chevron scylla-icon scylla-icon--triangle-down"></i></a>
                <ul class="menu scylla-dropdown__content">
                    <li>
                        <a href="https://docs.scylladb.com/">
                            <i class="scylla-icon scylla-icon--about-us"></i>
                            ScyllaDB Open Source
                        </a>
                    </li>
                    <li>
                        <a href="https://enterprise.docs.scylladb.com/">
                            <i class="scylla-icon scylla-icon--enterprise"></i>ScyllaDB Enterprise
                        </a>
                    </li>
                    <li>
                        <a href="https://scylla.docs.scylladb.com/stable/alternator/alternator.html">
                            <i class="scylla-icon scylla-icon--overview"></i>
                            ScyllaDB Alternator
                        </a>
                    </li>
                </ul>
            </li>
            <li class="scylla-dropdown__item">
                <a href="https://docs.scylladb.com/scylla-cloud/" class="scylla-dropdown__title">Cloud</a>
            </li>
            <li class="scylla-dropdown__item">
                <a href="#" class="scylla-dropdown__title">Tools <i
                    class="chevron scylla-icon scylla-icon--triangle-down"></i></a>
                <ul class="menu scylla-dropdown__content">
                    <li>
                        <a href="https://manager.docs.scylladb.com/">
                            <i class="scylla-icon scylla-icon--manager"></i>ScyllaDB Manager</a>
                    </li>
                    <li>
                        <a href="https://monitoring.docs.scylladb.com/">
                            <i class="scylla-icon scylla-icon--monitoring"></i>ScyllaDB
                            Monitoring Stack</a>
                    </li>
                    <li>
                        <a href="https://operator.docs.scylladb.com/">
                            <i class="scylla-icon scylla-icon--operator"></i>ScyllaDB Operator
                        </a>
                    </li>
                </ul>
            </li>
            <li class="scylla-dropdown__item">
                <a href="#" class="scylla-dropdown__title">Drivers <i
                    class="chevron scylla-icon scylla-icon--triangle-down"></i></a>
                <ul class="menu scylla-dropdown__content">
                    <li>
                        <a href="https://docs.scylladb.com/using-scylla/drivers/cql-drivers/">
                            <i class="scylla-icon scylla-icon--nsql-guides"></i>CQL Drivers
                        </a>
                    </li>
                    <li>
                        <a href="https://docs.scylladb.com/using-scylla/drivers/dynamo-drivers/">
                            <i class="scylla-icon scylla-icon--overview"></i>DynamoDB Drivers
                        </a>
                    </li>
                </ul>
            </li>
        </ul>
        <div class="header-button">
            <a href="https://www.scylladb.com/download/" class="button">Download</a>
        </div>
    </div>
    <div class="header-search-box">
        <div class="search-box">
            <ci-search></ci-search>
        </div>
    </div>
    <div class="side-nav-toggle" data-toggle="side-nav">
    <div class="side-nav-toggle__button">
        <img src="_static/img/menu.svg" alt="Menu" />
    </div>
</div>
</header>
        <section
            class="layout  layout--sidebar layout--has-secondary-sidebar ">
            <div class="content large-order-2">
                
                    
                
                
                    <div class="pre-content">
                        <div class="breadcrumbs">
    <span class="bread__item">
        <a href="https://docs.scylladb.com"
            class="bread__highlight">
            <i class="fas fa-home"></i> ScyllaDB Docs
        </a>
    </span>
    <span class="bread__item">
        <a href="index.html"
            class="bread__highlight">
            Scylla Operator
        </a>
    </span>
    
    <span class="bread__item bread__item--last">Monitoring</span>
</div>
                    </div>
                
                <section id="monitoring">
<h1>Monitoring<a class="headerlink" href="#monitoring" title="Permalink to this headline">¶</a></h1>
<p>Scylla Operator 1.8 introduced a new API resource <code class="docutils literal notranslate"><span class="pre">ScyllaDBMonitoring</span></code>, allowing users to deploy a managed monitoring
setup for their Scylla Clusters.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">scylla.scylladb.com/v1alpha1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ScyllaDBMonitoring</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">example</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Platform</span>
<span class="w">  </span><span class="nt">endpointsSelector</span><span class="p">:</span>
<span class="w">    </span><span class="nt">matchLabels</span><span class="p">:</span>
<span class="w">      </span><span class="nt">app.kubernetes.io/name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">scylla</span>
<span class="w">      </span><span class="nt">scylla-operator.scylladb.com/scylla-service-type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">identity</span>
<span class="w">      </span><span class="nt">scylla/cluster</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">replace-with-your-scyllacluster-name</span>
<span class="w">  </span><span class="nt">components</span><span class="p">:</span>
<span class="w">    </span><span class="nt">prometheus</span><span class="p">:</span>
<span class="w">      </span><span class="nt">storage</span><span class="p">:</span>
<span class="w">        </span><span class="nt">volumeClaimTemplate</span><span class="p">:</span>
<span class="w">          </span><span class="nt">spec</span><span class="p">:</span>
<span class="w">            </span><span class="nt">resources</span><span class="p">:</span>
<span class="w">              </span><span class="nt">requests</span><span class="p">:</span>
<span class="w">                </span><span class="nt">storage</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1Gi</span>
<span class="w">    </span><span class="nt">grafana</span><span class="p">:</span>
<span class="w">      </span><span class="nt">exposeOptions</span><span class="p">:</span>
<span class="w">        </span><span class="nt">webInterface</span><span class="p">:</span>
<span class="w">          </span><span class="nt">ingress</span><span class="p">:</span>
<span class="w">            </span><span class="nt">ingressClassName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">haproxy</span>
<span class="w">            </span><span class="nt">dnsDomains</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">test-grafana.test.svc.cluster.local</span>
<span class="w">            </span><span class="nt">annotations</span><span class="p">:</span>
<span class="w">              </span><span class="nt">haproxy-ingress.github.io/ssl-passthrough</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;true&quot;</span>
</pre></div>
</div>
<p>For details, refer to the below command:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>kubectl<span class="w"> </span>explain<span class="w"> </span>scylladbmonitorings.scylla.scylladb.com/v1alpha1
</pre></div>
</div>
<section id="deploy-managed-monitoring">
<h2>Deploy managed monitoring<a class="headerlink" href="#deploy-managed-monitoring" title="Permalink to this headline">¶</a></h2>
<p><strong>Note</strong>: as of v1.8, ScyllaDBMonitoring is experimental. The API is currently in version v1alpha1 and may change in future versions.</p>
<section id="requirements">
<h3>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline">¶</a></h3>
<p>Before you can set up your ScyllaDB monitoring, you need Scylla Operator already installed in your Kubernetes cluster.
For more information on how to deploy Scylla Operator, see:</p>
<ul class="simple">
<li><p><a class="reference internal" href="generic.html"><span class="doc">Deploying Scylla on a Kubernetes Cluster</span></a></p></li>
<li><p><a class="reference internal" href="helm.html"><span class="doc">Deploying Scylla stack using Helm Charts</span></a></p></li>
</ul>
<p>The above example of the monitoring setup also makes use of HAProxy Ingress and Prometheus Operator.
You can deploy them in your Kubernetes cluster using the provided third party examples. If you already have them deployed
in your cluster, you can skip the below steps.</p>
<section id="deploy-prometheus-operator">
<h4>Deploy Prometheus Operator<a class="headerlink" href="#deploy-prometheus-operator" title="Permalink to this headline">¶</a></h4>
<p>Deploy Prometheus Operator using kubectl:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>kubectl<span class="w"> </span>-n<span class="w"> </span>prometheus-operator<span class="w"> </span>apply<span class="w"> </span>--server-side<span class="w"> </span>-f<span class="w"> </span>./examples/third-party/prometheus-operator
</pre></div>
</div>
<section id="wait-for-prometheus-operator-to-roll-out">
<h5>Wait for Prometheus Operator to roll out<a class="headerlink" href="#wait-for-prometheus-operator-to-roll-out" title="Permalink to this headline">¶</a></h5>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>kubectl<span class="w"> </span>-n<span class="w"> </span>prometheus-operator<span class="w"> </span>rollout<span class="w"> </span>status<span class="w"> </span>--timeout<span class="o">=</span>5m<span class="w"> </span>deployments.apps/prometheus-operator
<span class="go">deployment &quot;prometheus-operator&quot; successfully rolled out</span>
</pre></div>
</div>
</section>
</section>
<section id="deploy-haproxy-ingress">
<h4>Deploy HAProxy Ingress<a class="headerlink" href="#deploy-haproxy-ingress" title="Permalink to this headline">¶</a></h4>
<p>Deploy HAProxy Ingress using kubectl:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>kubectl<span class="w"> </span>-n<span class="w"> </span>haproxy-ingress<span class="w"> </span>apply<span class="w"> </span>--server-side<span class="w"> </span>-f<span class="w"> </span>./examples/third-party/haproxy-ingress
</pre></div>
</div>
<section id="wait-for-haproxy-ingress-to-roll-out">
<h5>Wait for HAProxy Ingress to roll out<a class="headerlink" href="#wait-for-haproxy-ingress-to-roll-out" title="Permalink to this headline">¶</a></h5>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>kubectl<span class="w"> </span>-n<span class="w"> </span>haproxy-ingress<span class="w"> </span>rollout<span class="w"> </span>status<span class="w"> </span>--timeout<span class="o">=</span>5m<span class="w"> </span>deployments.apps/haproxy-ingress
<span class="go">deployment &quot;haproxy-ingress&quot; successfully rolled out</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="deploy-scylladbmonitoring">
<h3>Deploy ScyllaDBMonitoring<a class="headerlink" href="#deploy-scylladbmonitoring" title="Permalink to this headline">¶</a></h3>
<p>First, update the <code class="docutils literal notranslate"><span class="pre">endpointsSelector</span></code> in <code class="docutils literal notranslate"><span class="pre">examples/monitoring/v1alpha1/scylladbmonitoring.yaml</span></code> with a label
matching your ScyllaCluster instance name.</p>
<p>Deploy the monitoring setup using kubectl:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>kubectl<span class="w"> </span>-n<span class="w"> </span>scylla<span class="w"> </span>apply<span class="w"> </span>--server-side<span class="w"> </span>-f<span class="w"> </span>./examples/monitoring/v1alpha1/scylladbmonitoring.yaml
</pre></div>
</div>
<p>Scylla Operator will notice the new ScyllaDBMonitoring object, and it will reconcile all necessary resources.</p>
<section id="wait-for-scylladbmonitoring-to-roll-out">
<h4>Wait for ScyllaDBMonitoring to roll out<a class="headerlink" href="#wait-for-scylladbmonitoring-to-roll-out" title="Permalink to this headline">¶</a></h4>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>kubectl<span class="w"> </span><span class="nb">wait</span><span class="w"> </span>--for<span class="o">=</span><span class="s1">&#39;condition=Progressing=False&#39;</span><span class="w"> </span>scylladbmonitorings.scylla.scylladb.com/example
<span class="go">scylladbmonitoring.scylla.scylladb.com/example condition met</span>

<span class="gp">$ </span>kubectl<span class="w"> </span><span class="nb">wait</span><span class="w"> </span>--for<span class="o">=</span><span class="s1">&#39;condition=Degraded=False&#39;</span><span class="w"> </span>scylladbmonitorings.scylla.scylladb.com/example
<span class="go">scylladbmonitoring.scylla.scylladb.com/example condition met</span>

<span class="gp">$ </span>kubectl<span class="w"> </span><span class="nb">wait</span><span class="w"> </span>--for<span class="o">=</span><span class="s1">&#39;condition=Available=True&#39;</span><span class="w"> </span>scylladbmonitorings.scylla.scylladb.com/example
<span class="go">scylladbmonitoring.scylla.scylladb.com/example condition met</span>
</pre></div>
</div>
</section>
<section id="wait-for-prometheus-to-roll-out">
<h4>Wait for Prometheus to roll out<a class="headerlink" href="#wait-for-prometheus-to-roll-out" title="Permalink to this headline">¶</a></h4>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>kubectl<span class="w"> </span>rollout<span class="w"> </span>status<span class="w"> </span>--timeout<span class="o">=</span>5m<span class="w"> </span>statefulset.apps/prometheus-example
<span class="go">statefulset rolling update complete 1 pods at revision prometheus-example-65b89d55bb...</span>
</pre></div>
</div>
</section>
<section id="wait-for-grafana-to-roll-out">
<h4>Wait for Grafana to roll out<a class="headerlink" href="#wait-for-grafana-to-roll-out" title="Permalink to this headline">¶</a></h4>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>kubectl<span class="w"> </span>rollout<span class="w"> </span>status<span class="w"> </span>--timeout<span class="o">=</span>5m<span class="w"> </span>deployments.apps/example-grafana
<span class="go">deployment &quot;example-grafana&quot; successfully rolled out</span>
</pre></div>
</div>
</section>
</section>
<section id="accessing-grafana">
<h3>Accessing Grafana<a class="headerlink" href="#accessing-grafana" title="Permalink to this headline">¶</a></h3>
<p>For accessing Grafana service from outside the Kubernetes cluster we recommend using an Ingress, although there are many other ways to do so.
When using Ingress, what matters is to direct your packets to the ingress controller Service/Pods and have the correct TLS SNI field set by the caller when reaching out to the service, so it is routed properly, and your client can successfully validate the grafana serving certificate.
This is easier when you are using a real DNS domain that resolves to your Ingress controller’s IP address but most clients and tools allow setting the SNI field manually.</p>
</section>
<section id="prerequisites">
<h3>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline">¶</a></h3>
<p>To access Grafana, you first need to collect the serving CA and the credentials.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span><span class="nv">GRAFANA_SERVING_CERT</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span><span class="w"> </span>kubectl<span class="w"> </span>-n<span class="w"> </span>scylla<span class="w"> </span>get<span class="w"> </span>secret/example-grafana-serving-ca<span class="w"> </span>--template<span class="w"> </span><span class="s1">&#39;{{ index .data &quot;tls.crt&quot; }}&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>base64<span class="w"> </span>-d<span class="w"> </span><span class="k">)</span><span class="s2">&quot;</span>
<span class="gp">$ </span><span class="nv">GRAFANA_USER</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span><span class="w"> </span>kubectl<span class="w"> </span>-n<span class="w"> </span>scylla<span class="w"> </span>get<span class="w"> </span>secret/example-grafana-admin-credentials<span class="w"> </span>--template<span class="w"> </span><span class="s1">&#39;{{ index .data &quot;username&quot; }}&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>base64<span class="w"> </span>-d<span class="w"> </span><span class="k">)</span><span class="s2">&quot;</span>
<span class="gp">$ </span><span class="nv">GRAFANA_PASSWORD</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span><span class="w"> </span>kubectl<span class="w"> </span>-n<span class="w"> </span>scylla<span class="w"> </span>get<span class="w"> </span>secret/example-grafana-admin-credentials<span class="w"> </span>--template<span class="w"> </span><span class="s1">&#39;{{ index .data &quot;password&quot; }}&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>base64<span class="w"> </span>-d<span class="w"> </span><span class="k">)</span><span class="s2">&quot;</span>
</pre></div>
</div>
</section>
<section id="connecting-through-ingress-using-a-resolvable-domain">
<h3>Connecting through Ingress using a resolvable domain<a class="headerlink" href="#connecting-through-ingress-using-a-resolvable-domain" title="Permalink to this headline">¶</a></h3>
<p>In production clusters, the Ingress controller and appropriate DNS records should be set up already. Often there is already a generic wildcard record like <code class="docutils literal notranslate"><span class="pre">*.app.mydomain</span></code> pointing to the Ingress controller’s external IP. For custom service domains, it is usually a CNAME pointing to the Ingress controller’s A record.</p>
<p>Note: The ScyllaDBMonitoring example creates an Ingress object with <code class="docutils literal notranslate"><span class="pre">test-grafana.test.svc.cluster.local</span></code> DNS domain that you should adjust to your domain. Below examples use <code class="docutils literal notranslate"><span class="pre">example-grafana.apps.mydomain</span></code>.</p>
<p>Note: To test a resolvable domain from your machine without creating DNS records, you can adjust <code class="docutils literal notranslate"><span class="pre">/etc/hosts</span></code> or similar.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>curl<span class="w"> </span>--fail<span class="w"> </span>-s<span class="w"> </span>-o<span class="w"> </span>/dev/null<span class="w"> </span>-w<span class="w"> </span><span class="s1">&#39;%{http_code}&#39;</span><span class="w"> </span>-L<span class="w"> </span>--cacert<span class="w"> </span>&lt;<span class="o">(</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">GRAFANA_SERVING_CERT</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">)</span><span class="w"> </span><span class="s2">&quot;https://example-grafana.apps.mydomain&quot;</span><span class="w"> </span>--user<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">GRAFANA_USER</span><span class="si">}</span><span class="s2">:</span><span class="si">${</span><span class="nv">GRAFANA_PASSWORD</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="go">200</span>
</pre></div>
</div>
</section>
<section id="connecting-through-ingress-using-an-unresolvable-domain">
<h3>Connecting through Ingress using an unresolvable domain<a class="headerlink" href="#connecting-through-ingress-using-an-unresolvable-domain" title="Permalink to this headline">¶</a></h3>
<p>To connect to an Ingress without a resolvable domain you first need to find out your Ingress controller’s IP that can be resolved externally. Again, there are many ways to do so beyond the below examples.</p>
<p>Unless stated otherwise, we assume your Ingress is running on port 443.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span><span class="nv">INGRESS_PORT</span><span class="o">=</span><span class="m">443</span>
</pre></div>
</div>
<section id="variants">
<h4>Variants<a class="headerlink" href="#variants" title="Permalink to this headline">¶</a></h4>
<section id="ingress-externalip">
<h5>Ingress ExternalIP<a class="headerlink" href="#ingress-externalip" title="Permalink to this headline">¶</a></h5>
<p>When you are running in a real cluster there is usually a cloud LoadBalancer or a bare metal alternative providing you with an externally reachable IP address.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span><span class="nv">INGRESS_IP</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span><span class="w"> </span>kubectl<span class="w"> </span>-n<span class="o">=</span>haproxy-ingress<span class="w"> </span>get<span class="w"> </span>service/haproxy-ingress<span class="w"> </span>--template<span class="o">=</span><span class="s1">&#39;{{ ( index .status.loadBalancer.ingress 0 ).ip }}&#39;</span><span class="w"> </span><span class="k">)</span><span class="s2">&quot;</span>
</pre></div>
</div>
</section>
<section id="ingress-nodeport">
<h5>Ingress NodePort<a class="headerlink" href="#ingress-nodeport" title="Permalink to this headline">¶</a></h5>
<p>NodePort is slightly less convenient, but it’s available in development clusters as well.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span><span class="nv">INGRESS_IP</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span><span class="w"> </span>kubectl<span class="w"> </span>get<span class="w"> </span>nodes<span class="w"> </span>--template<span class="o">=</span><span class="s1">&#39;{{ $internal_ip := &quot;&quot; }}{{ $external_ip := &quot;&quot; }}{{ range ( index .items 0 ).status.addresses }}{{ if eq .type &quot;InternalIP&quot; }}{{ $internal_ip = .address }}{{ else if eq .type &quot;ExternalIP&quot; }}{{ $external_ip = .address }}{{ end }}{{ end }}{{ if $external_ip }}{{ $external_ip }}{{ else }}{{ $internal_ip }}{{ end }}&#39;</span><span class="w"> </span><span class="k">)</span><span class="s2">&quot;</span>
<span class="gp">$ </span><span class="nv">INGRESS_PORT</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span><span class="w"> </span>kubectl<span class="w"> </span>-n<span class="o">=</span>haproxy-ingress<span class="w"> </span>get<span class="w"> </span>services/haproxy-ingress<span class="w"> </span>--template<span class="o">=</span><span class="s1">&#39;{{ range .spec.ports }}{{ if eq .port 443 }}{{ .nodePort }}{{ end }}{{ end }}&#39;</span><span class="w"> </span><span class="k">)</span><span class="s2">&quot;</span>
</pre></div>
</div>
</section>
<section id="connection">
<h5>Connection<a class="headerlink" href="#connection" title="Permalink to this headline">¶</a></h5>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>curl<span class="w"> </span>--fail<span class="w"> </span>-s<span class="w"> </span>-o<span class="w"> </span>/dev/null<span class="w"> </span>-w<span class="w"> </span><span class="s1">&#39;%{http_code}&#39;</span><span class="w"> </span>-L<span class="w"> </span>--cacert<span class="w"> </span>&lt;<span class="o">(</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">GRAFANA_SERVING_CERT</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">)</span><span class="w"> </span><span class="s2">&quot;https://test-grafana.test.svc.cluster.local:</span><span class="si">${</span><span class="nv">INGRESS_PORT</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>--resolve<span class="w"> </span><span class="s2">&quot;test-grafana.test.svc.cluster.local:</span><span class="si">${</span><span class="nv">INGRESS_PORT</span><span class="si">}</span><span class="s2">:</span><span class="si">${</span><span class="nv">INGRESS_IP</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>--user<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">GRAFANA_USER</span><span class="si">}</span><span class="s2">:</span><span class="si">${</span><span class="nv">GRAFANA_PASSWORD</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="go">200</span>
</pre></div>
</div>
</section>
</section>
</section>
</section>
</section>

                
                    <div class="post-content">
                        <div class="content-navigation">
    <div class="navigation navigation--prev">
        
            <a class="navigation__link" href="manager.html">
                <button class="navigation__button">
                    <i class="scylla-icon scylla-icon--chevron-left"></i>
                </button>
                <div class="navigation__title">
                    <span class="colored">PREVIOUS</span> <br />Deploying Scylla Manager on a Kubernetes Cluster
                </div>
            </a>
        
    </div>
    <div class="navigation navigation--next">
        
            <a class="navigation__link" href="migration.html">
                <div class="navigation__title">
                    <span class="colored">NEXT</span> <br />Version  migrations
                </div>
                <button class="navigation__button">
                    <i class="scylla-icon scylla-icon--chevron-right"></i>
                </button>
            </a>
        
    </div>
</div>
                        <!-- Post content text -->
                    </div>
                
            </div>
            <div class="sidebar-left  large-order-1">
                
                    
                        <div id="side-nav" class="side-nav custom-scroll-bar" data-closable data-toggler=".show">
    <button class="collapsible-button">
        <i class="scylla-icon scylla-icon--chevron-left"></i>
    </button>
    <div class="side-nav-content">
        <div class="side-nav__search">
            <div class="search-box">
                <ci-search></ci-search>
            </div>
        </div>
        <div class="side-nav__title">
            Scylla Operator
        </div>
        <div class="side-nav__versions"><ul class="dropdown menu scylla-dropdown scylla-dropdown--versions" data-dropdown-menu>
    <li class="scylla-dropdown__item">
        <a class="scylla-dropdown__title" href="#">
            
                master
            
            <i class="chevron scylla-icon scylla-icon--chevron-right"></i>
        </a>
        <ul class="menu scylla-dropdown__content">
            
                
                    <li>
                        <a href="monitoring.html">master</a>
                    </li>
                
            
            
        </ul>
    </li>
</ul></div>
        <div class="side-nav__content">
            <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="generic.html">Deploying Scylla on a Kubernetes Cluster</a></li>
<li class="toctree-l1"><a class="reference internal" href="eks.html">Deploying Scylla on EKS</a></li>
<li class="toctree-l1"><a class="reference internal" href="gke.html">Deploying Scylla on GKE</a></li>
<li class="toctree-l1"><a class="reference internal" href="helm.html">Deploying Scylla stack using Helm Charts</a></li>
<li class="toctree-l1"><a class="reference internal" href="manager.html">Deploying Scylla Manager on a Kubernetes Cluster</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Monitoring</a></li>
<li class="toctree-l1"><a class="reference internal" href="migration.html">Version  migrations</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="nodeoperations/index.html">Node operations using Scylla Operator</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label for="toctree-checkbox-1"><i class="scylla-icon scylla-icon--expand"></i></label><div class="break"></div><ul>
<li class="toctree-l2"><a class="reference internal" href="nodeoperations/scylla_upgrade.html">Upgrading version of Scylla</a></li>
<li class="toctree-l2"><a class="reference internal" href="nodeoperations/replace_node.html">Replacing a Scylla node</a></li>
<li class="toctree-l2"><a class="reference internal" href="nodeoperations/automatic_cleanup.html">Automatic cleanup and replacement in case when k8s node is lost</a></li>
<li class="toctree-l2"><a class="reference internal" href="nodeoperations/maintenance_mode.html">Maintenance mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="nodeoperations/restore.html">Restore from backup</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="performance.html">Performance tuning</a></li>
<li class="toctree-l1"><a class="reference internal" href="upgrade.html">Upgrade of Scylla Operator</a></li>
<li class="toctree-l1"><a class="reference internal" href="releases.html">Releases</a></li>
<li class="toctree-l1"><a class="reference internal" href="known_issues.html">Known issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="scylla_cluster_crd.html">Scylla Cluster CRD</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing to Scylla Operator</a></li>
</ul>

        </div>
    </div>
</div>
                    
                
            </div>
            
                <div class="sidebar-right large-order-3">
                    <div class="secondary-side-nav custom-scroll-bar">
    
    <ul class="contribute">
        <li class="contribute__item">
            <a href="https://github.com/scylladb/scylla-operator/issues/new?title=docs:%20Issue in page Monitoring&&body=I%20would%20like%20to%20report%20an%20issue%20in%20page%20https://operator.docs.scylladb.com/master/monitoring%0A%0A%23%23%23%20Problem%0A%0A%23%23%23%20%20Suggest%20a%20fix&labels=documentation"
                target="_blank">
                <i class="icon fab fa-github" aria-hidden="true"></i>Create an issue
            </a>
        </li>
        
            <li class="contribute__item">
                <a href="https://github.com/scylladb/scylla-operator/edit/master/docs/source/monitoring.md"
                    target="_blank">
                    <i class="icon fa fa-edit" aria-hidden="true"></i>Edit this page
                </a>
            </li>
        
    </ul>

    
        <div class="secondary-side-nav__content">
            <p class="topic-title">On this page</p>
            <ul>
<li><a class="reference internal" href="#">Monitoring</a><ul>
<li><a class="reference internal" href="#deploy-managed-monitoring">Deploy managed monitoring</a><ul>
<li><a class="reference internal" href="#requirements">Requirements</a><ul>
<li><a class="reference internal" href="#deploy-prometheus-operator">Deploy Prometheus Operator</a><ul>
<li><a class="reference internal" href="#wait-for-prometheus-operator-to-roll-out">Wait for Prometheus Operator to roll out</a></li>
</ul>
</li>
<li><a class="reference internal" href="#deploy-haproxy-ingress">Deploy HAProxy Ingress</a><ul>
<li><a class="reference internal" href="#wait-for-haproxy-ingress-to-roll-out">Wait for HAProxy Ingress to roll out</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#deploy-scylladbmonitoring">Deploy ScyllaDBMonitoring</a><ul>
<li><a class="reference internal" href="#wait-for-scylladbmonitoring-to-roll-out">Wait for ScyllaDBMonitoring to roll out</a></li>
<li><a class="reference internal" href="#wait-for-prometheus-to-roll-out">Wait for Prometheus to roll out</a></li>
<li><a class="reference internal" href="#wait-for-grafana-to-roll-out">Wait for Grafana to roll out</a></li>
</ul>
</li>
<li><a class="reference internal" href="#accessing-grafana">Accessing Grafana</a></li>
<li><a class="reference internal" href="#prerequisites">Prerequisites</a></li>
<li><a class="reference internal" href="#connecting-through-ingress-using-a-resolvable-domain">Connecting through Ingress using a resolvable domain</a></li>
<li><a class="reference internal" href="#connecting-through-ingress-using-an-unresolvable-domain">Connecting through Ingress using an unresolvable domain</a><ul>
<li><a class="reference internal" href="#variants">Variants</a><ul>
<li><a class="reference internal" href="#ingress-externalip">Ingress ExternalIP</a></li>
<li><a class="reference internal" href="#ingress-nodeport">Ingress NodePort</a></li>
<li><a class="reference internal" href="#connection">Connection</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
    
</div>
                </div>
            
        </section>

        <footer class="footer">
    <div class="footer-group">
        <div class="footer-top">
            <a class="footer-logo" href="https://www.scylladb.com">
                <img src="_static/img/logo-scylla-horizontal-RGB.svg" alt="Logo" />
            </a>
            <div class="footer-links">
                <a class="footer-links__link" href="https://docs.scylladb.com/">Docs</a>
                <a class="footer-links__link" href="https://www.scylladb.com/company/contact-us/">Contact Us</a>
                <a class="footer-links__link" href="https://www.scylladb.com/company/">About Us</a>
            </div>
            <div class="footer-actions">
                <a class="footer-actions__link" href="https://groups.google.com/g/scylladb-users" target="_blank">
                    <span data-tooltip tabindex="1" title="User mailing list" data-position="bottom">
                        <img src="_static/img/icons/icon-mail-list.svg" alt="Mail List Icon" />
                    </span>
                </a>
                <a class="footer-actions__link" href="http://slack.scylladb.com/" target="_blank">
                    <span data-tooltip tabindex="1" title="User Slack channel" data-position="bottom">
                        <img src="_static/img/icons/icon-slack.svg" alt="Slack Icon" />
                    </span>
                </a>
                <a class="footer-actions__link" href="https://forum.scylladb.com/" target="_blank">
                    <span data-tooltip tabindex="1" title="Community forum" data-position="bottom">
                        <img src="_static/img/icons/icon-forum.svg" alt="Forum Icon" />
                    </span>
                </a>
            </div>
        </div>

        <div class="footer-bottom">
            
                <div class="footer-bottom__copyright">
                    
                        
                            &#169; 2023, ScyllaDB. All rights reserved.
                        
                    
                </div>
            
            
                <div class="footer-bottom__last-updated">
                    
                        Last updated on 18 May 2023.
                    
                </div>
            
            <div class="footer-bottom__version">
                Powered by
                <a href="http://sphinx-doc.org/">Sphinx 4.5.0</a> &amp;
                <a href="https://sphinx-theme.scylladb.com/">ScyllaDB Theme 1.3.5</a>
            </div>
        </div>
    </div>
</footer>

        <noscript>
            <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T8P2JP" height="0" width="0"
                style="display: none; visibility: hidden"></iframe>
        </noscript>
    </body>

</html>