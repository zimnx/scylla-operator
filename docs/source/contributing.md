# Contributing to Scylla Operator

## Prerequisites

To develop a scylla-operator, your environment must have the following:

1. [Go](https://golang.org/dl)
   * Check `go.mod` for minimal version requirement.
2. Git client
3. GitHub account

## Initial Setup

### Create a Fork

Follow GitHub documentation about creating a fork: https://docs.github.com/en/pull-requests/collaborating-with-pull-requests/working-with-forks/fork-a-repo

## Development

To add a feature or to make a bug fix, you will need to create a branch in your fork and then submit a pull request (PR) from the branch.
A subset of useful commands:
* `make build` - build project binaries
* `make test-unit` - run unit tests
* `make update` - run all code generators
* `make verify` - verify if all autogenerated changes are generated.

Check `make help` for more.

## Coding convention

This outlines guidelines, style suggestions, and tips for writing code throughout the Operator project.
The new code should follow the rules outlined in these:
* [Effective Go](https://go.dev/doc/effective_go)
* [Go Code Review Comments](https://go.dev/wiki/CodeReviewComments)
* [API changes](https://github.com/kubernetes/community/blob/master/contributors/devel/sig-architecture/api_changes.md)
* [API conventions](https://github.com/kubernetes/community/blob/master/contributors/devel/sig-architecture/api-conventions.md)


In case the existing code doesn't follow it, try to be consistent.
Make sure to familiarize yourself with these before preparing a change.

## Enhancement proposals

In case of bigger features or API changes, it's required to prepare an enhancement proposal beforehand as usually these require broader discussions.
For further details, check https://github.com/scylladb/scylla-operator/tree/master/enhancements.

## Submitting a Pull Request

Once you have implemented the feature or bug fix in your branch, you need to open a PR to the upstream repo.
Before opening the PR ensure you have added unit tests, all e2e's are passing, and your commit history is clean.

### Commit History

To prepare your branch to open a PR, you will need to have a minimal number of logical commits so we can maintain
a clean commit history. Most commonly, a PR includes a single commit where all changes are squashed and a separate commit for autogenerated changes.

### Commits and PRs

Please make the first line of your commit message, and PR title a summary of the change that a user of Operator would like to read, written in a single sentence.
Every release note is made out of just these first lines so make it good!

If you have more to say about the change, then enter a blank line and carry on the description.
Remember to say why the change was needed - the commit itself shows what was changed.

Writing more is better than less. Comparing the behavior before the change to that after the change is beneficial.
Imagine writing to yourself in 12 months when you've forgotten everything about what you just did, and you need to get up to speed quickly.

If the change fixes an issue, then write Fixes #1234 in the PR description.

Here is an example of a good commit message and PR title/description:
```

Add new XYZ field to ScyllaCluster CRD.

The new field allows for configuration of ZYX feature of ScyllaDB.
<more details>
API change was discussed in the following enhancement: <link>.

Fixes #1234
```

### Code review

Check [The Standard of Code Review](https://google.github.io/eng-practices/review/reviewer/standard.html) for guidelines 
about both doing a peer review for someone, and getting the feedback and reacting to remarks.

### Submitting

After getting a review feedback, apply and squash the changes into initial commits, don't add new commits. Your PR should be always in the mergeable state.
